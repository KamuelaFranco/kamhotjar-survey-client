"use strict";function generateUuid(e,t){for(t=e="";e++<36;t+=51*e&52?(15^e?8^Math.random()*(20^e?16:4):4).toString(16):"-");return t}function getUuid(){return window.localStorage["hotjar-survey-uuid"]}function setUuid(){window.localStorage["hotjar-survey-uuid"]=generateUuid()}function getPage(){return window.localStorage["hotjar-survey-page"]?Number(window.localStorage["hotjar-survey-page"]):1}function setPage(e){window.localStorage["hotjar-survey-page"]=Number(e)}function generateSurvey(e,t,r,n){try{e.removeChild(document.querySelector(".survey-first-input")),e.removeChild(document.querySelector(".survey-second-input"))}catch(a){console.warn("First rendering pass")}var u=document.createElement(t.elementType);u.className="survey-first-input",Object.keys(t).forEach(function(e){"elementType"!==e&&(u[e]=t[e])});var o=document.createElement(r.elementType);o.className="survey-second-input",Object.keys(r).forEach(function(e){"elementType"!==e&&(o[e]=r[e])});var l=document.querySelector(".survey-prev")||document.createElement("button");l.className="survey-prev",l.innerText="Previous Page",l.disabled=1===n;var i=document.querySelector(".survey-next")||document.createElement("button");i.className="survey-next",i.innerText=4===n?"Submit Survey":"Next Page",e.appendChild(noticeText),e.appendChild(u),e.appendChild(o),e.appendChild(l),e.appendChild(i),document.body.appendChild(e)}function drawSurveyPage(e){var t=[{elementType:"input",type:"text",name:"name",placeholder:"Name",required:!0},{elementType:"input",type:"number",name:"age",placeholder:"age",required:!0,min:10,max:99},{elementType:"input",type:"text",name:"address",placeholder:"Address"},{elementType:"input",type:"text",name:"favourite_book",placeholder:"Favourite book"}],r=[{elementType:"input",type:"email",name:"email",placeholder:"Email",required:!0},{elementType:"textarea",required:!0,name:"about_me",placeholder:"Tell us about yourself"},{elementType:"div",innerHTML:'<input type="radio" name="gender" value="1">Male<input type="radio" name="gender" value="2">Female'},{elementType:"div",innerHTML:'<input type="checkbox" name="red" value="red">Red<input type="checkbox" name="blue" value="blue">Blue<input type="checkbox" name="yellow" value="yellow">Yellow'}];switch(e){case 0:break;case 1:generateSurvey(surveyHtml,t[0],r[0],e);break;case 2:generateSurvey(surveyHtml,t[1],r[1],e);break;case 3:generateSurvey(surveyHtml,t[2],r[2],e);break;case 4:generateSurvey(surveyHtml,t[3],r[3],e)}}function postSurvey(e,t,r,n){var a=r?"PUT":"POST";r||(setUuid(),r=getUuid());var u={};if(u[e[0].name]=e[0].value,"div"===e[1].tagName.toLowerCase()){var o=e[1].childNodes[0].type;if("radio"===o){var l=0;e[1].childNodes.forEach(function(e){e.checked&&(l=e.value)}),u.gender=l}else"checkbox"===o&&!function(){var t=[];e[1].childNodes.forEach(function(e){e.checked&&t.push(e.value)}),u.favourite_colours=t.join()}()}else u[e[1].name]=e[1].value;u.uuid=r,n&&(u.is_complete=!0);var i=new XMLHttpRequest;i.open(a,t,!0),i.setRequestHeader("Content-Type","application/json"),i.send(JSON.stringify(u))}function prevPage(){var e=Number(getPage());1!==e&&(setPage(e-1),drawSurveyPage(getPage()))}function nextPage(){var e=Number(getPage());4===e?(setPage(0),document.querySelector(".hotjar-survey").remove()):(setPage(e+1),drawSurveyPage(getPage()))}var API_ENDPOINT="https://kamhotjar.herokuapp.com/survey",surveyHtml=document.createElement("div"),noticeText=document.createElement("span");surveyHtml.className="hotjar-survey",surveyHtml.style.margin="0 auto",surveyHtml.style.zIndex="9999",surveyHtml.style.backgroundColor="white",surveyHtml.style.position="absolute",surveyHtml.style.top="25%",surveyHtml.style.left="25%",surveyHtml.style.border="2px solid",surveyHtml.style.borderRadius="5px",surveyHtml.style.padding="10px",noticeText.className="hotjar-survey-notice",noticeText.style.color="red",document.addEventListener("DOMContentLoaded",window.setTimeout(function(){0!==getPage()&&(drawSurveyPage(getPage()),document.querySelector(".survey-prev").addEventListener("click",function(e){e.preventDefault(),prevPage()}),document.querySelector(".survey-next").addEventListener("click",function(e){e.preventDefault(),noticeText.textContent="";var t=document.querySelector(".survey-first-input"),r=document.querySelector(".survey-second-input");if(t.required&&!t.value||r.required&&!r.value)return void(noticeText.textContent="These fields are required");var n=[t,r];postSurvey(n,API_ENDPOINT,getUuid(),4===getPage()),nextPage()}))},2e3));